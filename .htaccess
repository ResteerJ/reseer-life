# ==============================
# Reseer J Blog .htaccess
# ==============================

# Use UTF-8 encoding
AddDefaultCharset UTF-8

# ---------------------------------
# Force HTTPS and remove www (optional)
# ---------------------------------
RewriteEngine On

# Redirect www to non-www (https://reseer.life)
RewriteCond %{HTTP_HOST} ^www\.reseer\.life [NC]
RewriteRule ^(.*)$ https://reseer.life/$1 [L,R=301]

# Force HTTPS (if user enters http://reseer.life)
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://reseer.life/$1 [L,R=301]

# ---------------------------------
# SEO-friendly URLs (remove .html or .php)
# ---------------------------------
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.html -f
RewriteRule ^([^/]+)/?$ $1.html [L]

RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_FILENAME}\.php -f
RewriteRule ^([^/]+)/?$ $1.php [L]

# ---------------------------------
# Cache optimization for performance
# ---------------------------------
<IfModule mod_expires.c>
  ExpiresActive On
  ExpiresByType image/jpg "access plus 1 year"
  ExpiresByType image/jpeg "access plus 1 year"
  ExpiresByType image/gif "access plus 1 year"
  ExpiresByType image/png "access plus 1 year"
  ExpiresByType text/css "access plus 1 month"
  ExpiresByType text/javascript "access plus 1 month"
  ExpiresByType application/javascript "access plus 1 month"
  ExpiresByType application/x-javascript "access plus 1 month"
  ExpiresByType text/html "access plus 1 day"
  ExpiresDefault "access plus 1 month"
</IfModule>

# ---------------------------------
# Security headers
# ---------------------------------
<IfModule mod_headers.c>
  Header always set X-Frame-Options "SAMEORIGIN"
  Header always set X-XSS-Protection "1; mode=block"
  Header always set X-Content-Type-Options "nosniff"
  Header always set Referrer-Policy "strict-origin-when-cross-origin"
  Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
  Header set Content-Security-Policy "default-src 'self' https: data: 'unsafe-inline' 'unsafe-eval';"
</IfModule>

# ---------------------------------
# Custom 404 and 403 pages
# ---------------------------------
ErrorDocument 404 /404.html
ErrorDocument 403 /403.html

# ---------------------------------
# Disable directory browsing
# ---------------------------------
Options -Indexes

# ---------------------------------
# Protect system files
# ---------------------------------
<FilesMatch "(^\.|config\.php|composer\.json|composer\.lock|readme\.md|LICENSE)">
  Order allow,deny
  Deny from all
</FilesMatch>
